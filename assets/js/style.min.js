var baseURL=window.location.protocol+"//"+window.location.host+"/artGallery/";$(document).ready((function(){var idleTimer,logoutUrl="logout",hasRedirected=!1;function redirectLogout(){hasRedirected||(hasRedirected=!0,window.location.href=logoutUrl)}function resetIdleTimer(){clearTimeout(idleTimer),idleTimer=setTimeout(redirectLogout,18e5)}$(document).on("mousemove keydown scroll",resetIdleTimer),$((function(){resetIdleTimer()})),$(document).on("click","#sidebar-toggle",(function(e){e.preventDefault(),$(".backdrop").toggleClass("backdropactive"),$("#sidebar").toggleClass("active")})),$(document).on("click",".backdrop",(function(e){e.preventDefault(),$(".backdrop").removeClass("backdropactive"),$("#sidebar").removeClass("active")})),$(window).on("scroll",(function(event){$(window).scrollTop()>0?$(".header").addClass("fixed"):$(".header").removeClass("fixed")})),$(document).on("click","#dropmedown",(function(e){e.preventDefault(),$("#mydropdown").toggleClass("open")})),$(document).on("click",".crtacnt",(function(e){e.preventDefault(),$("#logInModal").removeClass("active"),$("#signInModal").addClass("active")})),$(document).on("click",".lgtacnt",(function(e){e.preventDefault(),$("#signInModal").removeClass("active"),$("#logInModal").addClass("active")})),$(document).on("click",".signInbtn",(function(e){e.preventDefault(),$("#signInModal").addClass("active")})),$(document).on("click","#closeme",(function(e){e.preventDefault(),$("#signInModal").removeClass("active")})),$(document).on("click","#closeit",(function(e){e.preventDefault(),$("#logInModal").removeClass("active")})),$(document).on("click","#shareBtn_01",(function(e){e.preventDefault(),$("#shareModal").addClass("active"),$(".shr-modal-content").addClass("active");var imageSrc=$(this).closest(".painting_canvas").find("img.art_canvas").attr("src");$(".shrmgmd01").attr("src",imageSrc),$("._cpyurl").val(baseURL+imageSrc)})),$(document).on("click","#shrmdlclose",(function(e){e.preventDefault(),$("#shareModal").removeClass("active"),$(".shr-modal-content").removeClass("active"),$(".shrmgmd01").attr("src",""),$("._cpyurl").val("")})),$(document).on("click","._twshrbt",(function(e){e.preventDefault();var imageSrc=$(".art_canvas").attr("src"),tweetUrl="https://twitter.com/intent/tweet?url="+encodeURIComponent(baseURL+imageSrc)+"&text="+encodeURIComponent("Check out this image!");window.open(tweetUrl,"_blank")})),$(document).on("click","._fbshrbt",(function(e){e.preventDefault();var imageSrc=$(".art_canvas").attr("src"),fbUrl="https://www.facebook.com/sharer/sharer.php?u="+encodeURIComponent(baseURL+imageSrc);window.open(fbUrl,"_blank")})),$("#rsndotp").addClass("_0rgSaz").prop("disabled",!0);var interval,timer=60;function startTimer(){interval=setInterval((function(){var time,minutes,seconds;$("#timrstrd").text((time=timer,((minutes=Math.floor(time/60))<10?"0"+minutes:minutes)+":"+((seconds=time%60)<10?"0"+seconds:seconds))),--timer<0&&(clearInterval(interval),$("#rsndotp").removeClass("_0rgSaz").prop("disabled",!1))}),1e3)}$(document).on("click","#sbmtcrtacnt",(function(e){e.preventDefault();var name=$("#inputname2").val(),email=$("#inputEmail2").val(),password=$("#inputPassword2").val();""===name?$(".msgerror1").text("Invalid Field: Name cannot be empty"):/^[A-Za-z\s]+$/.test(name)?""===email?$(".msgerror2").text("Invalid Field: Email should be empty"):/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/.test(email)?""===password?$(".msgerror3").text("Invalid Field: Password cannot be empty"):password.length<8?$(".msgerror3").text("Invalid Field: Password should be at least 8 characters"):$.ajax({type:"POST",url:baseURL+"signin/createAccount",dataType:"json",data:{name:name,email:email,password:password},beforeSend:function(){$("#sbmtcrtacnt").html('<div class="spinner-border text-light" role="status"></div>')},success:function(response){$("#sbmtcrtacnt").html("Continue"),"1"==response.success||"Registration Successful"==response.success?($("._crdenfld").addClass("d-none"),$("._authfld").removeClass("d-none"),$(".svmsg").html('<p class="svmsgP _smgrn">We`ve sent you an OTP to your email address</p>'),startTimer()):"0"==response.error||"Data not received!"==response.error?$(".svmsg").html('<p class="svmsgP _smred">Email address already exists!</p>'):$(".svmsg").html("")},error:function(xhr,status,error){console.log("Error:",error)}}):$(".msgerror2").text("Invalid Field: Email is invalid"):$(".msgerror1").text("Invalid Field: Name should only contain alphabets")})),$(document).on("click","#rsndotp",(function(e){e.preventDefault(),$("#rsndotp").addClass("_0rgSaz").prop("disabled",!0),clearInterval(interval),$("#timrstrd").text("00:00"),timer=60,startTimer();var email=$("#inputEmail2").val();$.ajax({type:"POST",url:baseURL+"signin/resend",dataType:"json",data:{email:email},success:function(response){"1"==response.success||"OTP Resent"==response.success?$(".svmsg").html('<p class="svmsgP _smgrn">We`ve resent you an OTP on your email address</p>'):"0"==response.error||"Data not received!"==response.error?$(".svmsg").html('<p class="svmsgP _smred">Something went wrong!</p>'):$(".svmsg").html("")},error:function(xhr,status,error){console.log(xhr.responseText)}})})),$(document).on("click","#vrfotp",(function(e){e.preventDefault();var otp=$("#inputotp1").val();6!==otp.replace(/\D/g,"").length?$(".msgerror4").text("Invalid OTP"):$.ajax({type:"POST",url:baseURL+"signin/verify",dataType:"json",data:{otp:otp},beforeSend:function(){$("#vrfotp").html('<div class="spinner-border text-light" role="status"></div>')},success:function(response){$("#vrfotp").html("Continue"),"1"==response.success||"Account Verified"==response.success?($("#signInModal").removeClass("active"),$("#logInModal").addClass("active"),$("._crdenfld").addClass("d-flex"),$("._authfld").addClass("d-none")):response.error?$(".svmsg").html('<p class="svmsgP _smred">'+response.error+"</p>"):$(".svmsg").html("")},error:function(xhr,status,error){console.log(xhr.responseText)}})})),$(document).on("click","#lg2web",(function(e){e.preventDefault();var email=$("#inputEmail1").val(),password=$("#inputPassword1").val();""===email?$(".msgerror5").text("Invalid Field: Email should be empty"):/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/.test(email)?""===password?$(".msgerror6").text("Invalid Field: Password cannot be empty"):password.length<8?$(".msgerror6").text("Invalid Field: Password should be at least 8 characters"):$.ajax({type:"POST",url:baseURL+"signin/login",dataType:"json",data:{email:email,password:password},beforeSend:function(){$("#lg2web").html('<div class="spinner-border text-light" role="status"></div>')},success:function(response){$("#lg2web").html("Continue"),"1"==response.success||"Welcome Back!"==response.success?window.location.href=window.location.href:response.error?$(".svmsg").html('<p class="svmsgP _smred">'+response.error+"</p>"):$(".svmsg").html("")},error:function(xhr,status,error){console.log("Error:",error)}}):$(".msgerro5").text("Invalid Field: Email is invalid")})),$(document).on("keyup","._0keyinemp",(function(e){e.preventDefault(),$(this).val().length>0&&($(".inputMsg").text(""),$(".svmsg").html(""))})),$(document).on("click","#uplbtnndop",(function(e){e.preventDefault(),$(".upl_modal").addClass("active")})),$(document).on("click","#closeitup",(function(e){e.preventDefault(),$(".upl_modal").removeClass("active")}));var previewContainer=$("#preview-container"),uploadButton=$(".btn-upload"),uploadedFiles=[];function createInputChangeListener(fileData,property){return function(e){fileData[property]=e.target.value}}function updateUploadButtonState(){uploadedFiles.length>0?uploadButton.show():uploadButton.hide()}function loadData(){$.ajax({url:baseURL+"upmg/fetchProfile",type:"GET",dataType:"json",success:function(response){console.log(response),$("#shmprodata").html(response),$(".upl_modal").removeClass("active")},error:function(xhr,status,error){console.error("AJAX request error:",error)}})}$(document).on("change","#upload",(function(e){for(var files=e.target.files,i=0;i<files.length;i++){if(uploadedFiles.length>=4){alert("You can only select up to 4 files.");break}var file=files[i];if("image/jpeg"===file.type||"image/png"===file.type)if(file.size>5242880)alert("Please select images smaller than 5MB.");else{var fileData={file:file,title:"",description:"",location:""};uploadedFiles.push(fileData);var imageBox=$('<div class="col-md-2 image-box"></div>'),image=$('<div class="prvimg"><img class="img-fluid" src="'+URL.createObjectURL(file)+'"></div>'),imageDetails=$('<div class="image-details"></div>'),titleInput=$('<input type="text" class="imgttl _imginf" placeholder="Title">'),descriptionInput=$('<input type="text" class="imgdes _imginf" placeholder="Description">'),locationInput=$('<input type="text" class="imgloc _imginf" placeholder="Location">'),removeButton=$('<button class="remove-btn" id="removebtnimg"><i class="fa-solid fa-x"></i></button>');image.append(removeButton),titleInput.on("input",createInputChangeListener(fileData,"title")),descriptionInput.on("input",createInputChangeListener(fileData,"description")),locationInput.on("input",createInputChangeListener(fileData,"location")),imageBox.append(image),imageDetails.append(titleInput),imageDetails.append(descriptionInput),imageDetails.append(locationInput),imageBox.append(imageDetails),previewContainer.append(imageBox)}else alert("Please select only JPEG or PNG images.")}updateUploadButtonState()})),$(document).on("click",".remove-btn",(function(){var imageBox=$(this).closest(".image-box"),index=imageBox.index();uploadedFiles.splice(index,1),imageBox.remove(),updateUploadButtonState()})),$(document).on("click",".btn-upload",(function(e){e.preventDefault();var isAnyFieldEmpty=uploadedFiles.some((function(fileData){return""===fileData.title||""===fileData.description||""===fileData.location}));if(isAnyFieldEmpty)alert("Title, description, and location fields cannot be empty.");else{for(var formData=new FormData,i=0;i<uploadedFiles.length;i++){var fileData=uploadedFiles[i];formData.append("files[]",fileData.file),formData.append("titles[]",fileData.title),formData.append("descriptions[]",fileData.description),formData.append("locations[]",fileData.location)}$.ajax({url:baseURL+"images/uploadImg",type:"POST",processData:!1,contentType:!1,data:formData,success:function(response){console.log("Images uploaded successfully:",response),$("#preview-container").empty(),uploadedFiles=[],updateUploadButtonState(),$(".upl_modal").removeClass("active"),loadData()},error:function(error){console.error("Error uploading images:",error)}})}})),loadData(),$(document).on("click",".likemebtn",(function(e){e.preventDefault();var $heartIcon=$(this).find("i");$heartIcon.toggleClass("saved");var imageId=$(this).data("image-id"),isLiked=$heartIcon.hasClass("saved")?1:0;$.ajax({url:baseURL+"others/collection",method:"POST",data:{imageId:imageId,isLiked:isLiked},success:function(response){console.log(response)},error:function(xhr,status,error){}})})),$(document).on("click","._dlBtn",(function(e){e.preventDefault();var id=$(this).closest("._dwf07ll").data("id");$.ajax({url:baseURL+"delete/delt",method:"POST",data:{id:id},success:function(response){console.log(response),loadData()},error:function(xhr,status,error){}})})),$(document).on("click",".profile-upload",(function(){var file=$("#profilepicture")[0].files[0],dob=$("#dob").val();if(!file||!dob)return file?$(".msgerror20").text(""):$(".msgerror20").text("Please choose a profile picture"),void(dob?$(".msgerror19").text(""):$(".msgerror19").text("Please enter your date of birth"));if(file.size>5242880)$(".msgerror20").text("Please choose an image smaller than 5 MB");else{$(".msgerror20").text("");var fileExtension=file.name.split(".").pop().toLowerCase();if("jpg"===fileExtension||"png"===fileExtension){$(".msgerror20").text("");var formData=new FormData;formData.append("files",file),formData.append("dob",dob),$.ajax({url:baseURL+"others/profileEdit",type:"POST",data:formData,processData:!1,contentType:!1,success:function(response){window.location.href=window.location.href},error:function(xhr,status,error){console.error(error)}})}else $(".msgerror20").text("Please choose a JPG or PNG image")}})),$(document).on("click",".prfedbtn",(function(e){e.preventDefault(),$(".prfl_modal").addClass("active")})),$(document).on("click","#closeitupprf",(function(e){e.preventDefault(),$(".prfl_modal").removeClass("active")})),$(document).on("focus",".search",(function(){$(".art_autocomplete").addClass("active"),$(".art_bLrB4CN70D_content_search").addClass("active")})),$(document).on("click",(function(event){$(event.target).closest(".art_bLrB4CN70D_content_search").length||$(".art_autocomplete").removeClass("active")})),$(document).on("keyup focus",".search",(function(){$(".art_autocomplete").addClass("active");var query=$(this).val();""!==query?$.ajax({url:baseURL+"home/search",type:"POST",data:{query:query},dataType:"json",success:function(response){console.log(response);var autocompleteList=$(".art_autocomplete > ul");autocompleteList.empty(),response.length>0?$.each(response,(function(index,item){var url="s.php?t="+encodeURIComponent(item.title);autocompleteList.append('<li><a href="sr?t='+url+'">'+item.title+"</a></li>")})):autocompleteList.append("<p>No Result Found</p>"),$(".art_autocomplete").addClass("active")},error:function(xhr,status,error){console.error("AJAX request error:",error)}}):$(".art_autocomplete").removeClass("active")})),$(document).on("click","#reqstSent",(function(e){e.preventDefault(),$(".inputMsg").text("");var isValid=!0;if(""===$("#inputName3").val()&&($("#nameHelp3").text("Name is required."),isValid=!1),""===$("#inputEmail3").val()&&($("#emailHelp3").text("Email is required."),isValid=!1),""===$("#inputReason3").val()&&($("#reasonHelp3").text("Reason is required."),isValid=!1),""===$("#textareaDetails3").val()&&($("#detailsHelp3").text("Details are required."),isValid=!1),isValid){var formData={name:$(".cntinputName3").val(),email:$(".cntinputEmail3").val(),reason:$(".cntinputReason3").val(),details:$("#textareaDetails3").val()};$.ajax({url:baseURL+"contact/messaging",type:"POST",data:formData,dataType:"json",beforeSend:function(){$(".reqstSent").html('<div class="spinner-border text-light" role="status"></div>')},success:function(response){$(".reqstSent").html("Submit Request"),response.success?alert("Message Sent!"):console.log("something went wrong!")},error:function(jqXHR,textStatus,errorThrown){console.error(textStatus,errorThrown)}})}})),$(document).on("click",".loadMoredata",(function(){fetchData()}));var limit=10,offset=0;function fetchData(){$.ajax({url:baseURL+"home/fetchData",type:"GET",data:{offset:offset},success:function(response){console.log(response),$("#hmdatimg").append(response),offset+=10,response.length<limit&&$(".loadMoredata").prop("disabled",!0)},error:function(xhr,status,error){console.error("AJAX request error:",error)}})}fetchData(),$(document).on("click",".publisher",(function(e){e.preventDefault();var imageID=$(this).closest(".painting_canvas").data("image-id"),uidn=$(this).closest(".painting_canvas").data("uidn");$.ajax({url:baseURL+"home/artboard",method:"POST",dataType:"json",data:{imageID:imageID,uidn:uidn},success:function(response){$(".artist_modal").addClass("active"),$("#myartgallery").html(response)},error:function(xhr,status,error){console.log(error)}})})),$(document).on("click","#closemeart",(function(e){e.preventDefault(),$(".artist_modal").removeClass("active")})),$(document).on("click",".downloadmedown",(function(e){e.preventDefault();var imageID=$(this).closest(".painting_canvas").data("image-id");void 0!==imageID||$(this).closest(".painting_canvas").data("id");var file=$(this).data("file"),key=$(this).data("key"),extension=file.split(".").pop();$("<a>").attr({href:"assets/upload/"+file,download:"ArtG_"+key+"."+extension})[0].click(),console.log(imageID),$.ajax({url:baseURL+"images/downCount",method:"POST",dataType:"json",data:{imageID:imageID},success:function(response){console.log(response),console.log("1")},error:function(xhr,status,error){console.error("Error updating download count: "+error)}})}))}));